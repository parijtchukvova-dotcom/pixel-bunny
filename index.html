<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pixel Bunny Mario</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html,body{margin:0;padding:0;overflow:hidden;background:#6ec6ff;}
canvas{display:block;}
#ui{
position:fixed;top:8px;left:8px;
background:rgba(255,255,255,0.8);
padding:6px 10px;border-radius:10px;
font-family:monospace;font-size:14px;
z-index:10;
}
#controls{
position:fixed;bottom:10px;left:0;right:0;
display:flex;justify-content:space-between;
padding:0 20px;z-index:10;
}
.btn{
width:60px;height:60px;border-radius:50%;
background:rgba(0,0,0,0.4);
color:white;font-size:28px;
display:flex;align-items:center;justify-content:center;
user-select:none;
}
</style>
</head>

<body>
<div id="ui">üê∞ Lives: <span id="lives">3</span> | ü™ô Coins: <span id="coins">0</span></div>

<canvas id="game"></canvas>

<div id="controls">
<div class="btn" id="left">‚óÄ</div>
<div class="btn" id="jump">‚ñ≤</div>
<div class="btn" id="right">‚ñ∂</div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

let camX=0;

const gravity=0.6;
const jumpPower=14;
const speed=3;

const player={
x:100,y:200,w:28,h:28,
dx:0,dy:0,
onGround:false,
lives:3,
coins:0
};

const platforms=[
{x:0,y:canvas.height-60,w:4000,h:60},
{x:300,y:canvas.height-160,w:160,h:20},
{x:550,y:canvas.height-240,w:160,h:20},
{x:820,y:canvas.height-300,w:160,h:20},
{x:1100,y:canvas.height-200,w:160,h:20},
{x:1400,y:canvas.height-260,w:200,h:20},
{x:1750,y:canvas.height-320,w:180,h:20}
];

let enemies=[
{x:600,y:canvas.height-100,w:26,h:26,dx:1.2,alive:true},
{x:1300,y:canvas.height-100,w:26,h:26,dx:-1.2,alive:true}
];

let coins=[
{x:340,y:canvas.height-200,r:6,collected:false},
{x:590,y:canvas.height-280,r:6,collected:false},
{x:860,y:canvas.height-340,r:6,collected:false},
{x:1150,y:canvas.height-240,r:6,collected:false}
];

const keys={};

document.addEventListener("keydown",e=>keys[e.key]=true);
document.addEventListener("keyup",e=>keys[e.key]=false);

// mobile
["left","right","jump"].forEach(id=>{
document.getElementById(id).ontouchstart=e=>{
e.preventDefault();
keys[id]=true;
};
document.getElementById(id).ontouchend=e=>{
e.preventDefault();
keys[id]=false;
};
});

function rects(a,b){
return a.x<a.x+b.w &&
a.x+a.w>b.x &&
a.y<a.y+b.h &&
a.y+a.h>b.y;
}

function update(){
player.dx=0;
if(keys["ArrowLeft"]||keys["left"])player.dx=-speed;
if(keys["ArrowRight"]||keys["right"])player.dx=speed;

if((keys[" "]||keys["ArrowUp"]||keys["jump"]) && player.onGround){
player.dy=-jumpPower;
player.onGround=false;
}

player.dy+=gravity;
player.x+=player.dx;
player.y+=player.dy;

player.onGround=false;

platforms.forEach(p=>{
if(
player.x< p.x+p.w &&
player.x+player.w>p.x &&
player.y+player.h>p.y &&
player.y+player.h< p.y+20
){
player.y=p.y-player.h;
player.dy=0;
player.onGround=true;
}
});

// enemies
enemies.forEach(e=>{
if(!e.alive)return;
e.x+=e.dx;
platforms.forEach(p=>{
if(e.x< p.x+p.w && e.x+e.w>p.x &&
e.y+e.h>p.y && e.y+e.h< p.y+20){
e.y=p.y-e.h;
}
});

// stomp logic
if(
player.x<e.x+e.w &&
player.x+player.w>e.x &&
player.y+player.h>e.y &&
player.y+player.h<e.y+15 &&
player.dy>0
){
e.alive=false;
player.dy=-8; // bounce
}else if(
player.x<e.x+e.w &&
player.x+player.w>e.x &&
player.y<e.y+e.h &&
player.y+player.h>e.y &&
e.alive
){
player.lives--;
player.x=100;
player.y=100;
}
});

// coins
coins.forEach(c=>{
if(c.collected)return;
const dx=player.x-(c.x-camX);
const dy=player.y-c.y;
if(Math.sqrt(dx*dx+dy*dy)<20){
c.collected=true;
player.coins++;
}
});

camX=player.x-200;
if(camX<0)camX=0;

document.getElementById("lives").innerText=player.lives;
document.getElementById("coins").innerText=player.coins;
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

// platforms
ctx.fillStyle="#7a4a1f";
platforms.forEach(p=>{
ctx.fillRect(p.x-camX,p.y,p.w,p.h);
});

// coins
ctx.fillStyle="gold";
coins.forEach(c=>{
if(!c.collected){
ctx.beginPath();
ctx.arc(c.x-camX,c.y,c.r,0,Math.PI*2);
ctx.fill();
}
});

// enemies
enemies.forEach(e=>{
if(e.alive){
ctx.fillStyle="red";
ctx.fillRect(e.x-camX,e.y,e.w,e.h);
}
});

// player (bunny block for now)
ctx.fillStyle="white";
ctx.fillRect(player.x-camX,player.y,player.w,player.h);
}

function loop(){
update();
draw();
requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
